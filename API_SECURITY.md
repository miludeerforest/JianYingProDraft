# 🔐 API密钥安全说明

## 🛡️ 安全原则

### ⚠️ 重要提醒
- **绝不在公开代码中暴露API密钥**
- **不要将包含真实API密钥的配置文件提交到Git**
- **定期更换API密钥以确保安全**
- **使用环境变量或配置文件管理敏感信息**

## 🔑 Pexels API密钥管理

### 📋 获取API密钥

1. **访问Pexels开发者页面**
   - 网址: https://www.pexels.com/api/
   - 免费注册开发者账户

2. **申请API密钥**
   - 登录后进入开发者控制台
   - 创建新的API应用
   - 获取免费的API密钥

3. **API使用限制**
   - 免费版本: 200次/小时, 20,000次/月
   - 付费版本: 更高的请求限制

### ⚙️ 配置API密钥

#### 方法1: 配置文件设置
```ini
[JianYingDraft.automix]
pexels_api_key=your_actual_api_key_here
```

#### 方法2: 环境变量设置
```bash
# Windows
set PEXELS_API_KEY=your_actual_api_key_here

# Linux/Mac
export PEXELS_API_KEY=your_actual_api_key_here
```

#### 方法3: 程序内设置
通过交互式菜单 `4. 🛡️ Pexels防审核设置` 进行配置

## 🔒 安全最佳实践

### 📁 文件安全
- **配置文件**: 将 `_projectConfig.ini` 添加到 `.gitignore`
- **环境文件**: 使用 `.env` 文件存储敏感信息
- **备份安全**: 备份文件也要注意密钥保护

### 🔄 密钥轮换
- **定期更换**: 建议每3-6个月更换一次API密钥
- **泄露处理**: 如发现密钥泄露，立即在Pexels控制台撤销并重新生成
- **多环境管理**: 开发、测试、生产环境使用不同的API密钥

### 👥 团队协作
- **密钥分发**: 通过安全渠道分发API密钥，不要通过聊天工具
- **权限控制**: 只给需要的团队成员提供API密钥
- **文档记录**: 记录密钥的使用范围和有效期

## 🛠️ 技术实现

### 🔧 代码中的安全处理

#### 配置读取优先级
```python
# 1. 环境变量优先
api_key = os.getenv('PEXELS_API_KEY')

# 2. 配置文件次之
if not api_key:
    api_key = config.get('pexels_api_key')

# 3. 内置默认最后
if not api_key:
    api_key = 'default_key_for_demo'
```

#### 密钥验证
```python
def validate_api_key(api_key):
    """验证API密钥有效性"""
    if not api_key or api_key == 'your_pexels_api_key_here':
        return False
    # 进行实际的API调用验证
    return test_api_connection(api_key)
```

### 📊 错误处理
- **密钥无效**: 提示用户检查密钥配置
- **请求限制**: 显示剩余请求次数和重置时间
- **网络错误**: 自动切换到备用方案

## 🚨 应急处理

### 🔍 密钥泄露检测
- **代码扫描**: 定期扫描代码库是否包含硬编码密钥
- **日志检查**: 确保日志文件不包含完整的API密钥
- **版本控制**: 检查Git历史记录是否有密钥泄露

### 🛡️ 泄露后处理
1. **立即撤销**: 在Pexels控制台立即撤销泄露的密钥
2. **生成新密钥**: 创建新的API密钥
3. **更新配置**: 在所有使用该密钥的地方更新
4. **监控异常**: 监控是否有异常的API使用

## 📋 检查清单

### ✅ 开发阶段
- [ ] API密钥不在源代码中硬编码
- [ ] 配置文件已添加到 `.gitignore`
- [ ] 使用环境变量或安全配置管理
- [ ] 代码中有密钥验证逻辑

### ✅ 部署阶段
- [ ] 生产环境使用独立的API密钥
- [ ] 配置文件权限设置正确
- [ ] 备份文件不包含敏感信息
- [ ] 监控和日志配置安全

### ✅ 维护阶段
- [ ] 定期检查API密钥使用情况
- [ ] 监控异常的API调用
- [ ] 定期更换API密钥
- [ ] 团队成员变动时更新密钥

## 💡 使用建议

### 🎯 个人用户
- 申请个人的Pexels API密钥
- 将密钥保存在安全的配置文件中
- 不要在社交媒体或论坛分享密钥

### 🏢 企业用户
- 使用企业级的API密钥管理方案
- 建立密钥轮换和监控机制
- 制定API密钥安全使用规范

### 🔧 开发者
- 在开发环境使用测试密钥
- 生产环境使用正式密钥
- 实现密钥的动态配置和验证

## 📞 技术支持

### 🆘 遇到问题时
1. **检查密钥配置**: 确认API密钥设置正确
2. **验证网络连接**: 确保可以访问Pexels API
3. **查看错误日志**: 检查具体的错误信息
4. **联系技术支持**: 提供详细的错误描述（不要包含真实密钥）

### 📧 获取帮助
- **GitHub Issues**: 提交技术问题（注意不要包含真实密钥）
- **Pexels支持**: API相关问题可联系Pexels官方支持
- **社区论坛**: 在相关技术社区寻求帮助

---

## 🔐 安全提醒

**请始终记住：API密钥是敏感信息，需要妥善保护。任何泄露都可能导致服务滥用和安全风险。**

**🛡️ 安全第一，谨慎使用！**
