# 🎬 剪映自动混剪工具

智能视频混剪工具，基于pyJianYingDraft库开发，支持自动生成剪映草稿文件，包含特效、滤镜、转场、字幕、防审核覆盖层等完整功能。

## ✨ 核心特色

- 🎯 **交互式操作界面** - 友好的菜单式操作，无需记忆复杂命令
- 📱 **9:16竖屏优化** - 专为短视频平台设计的竖屏格式
- 🛡️ **Pexels防审核覆盖层** - 5%不透明度风景覆盖，有效防止平台识别
- 🎨 **智能特效系统** - 912种特效、468种滤镜、362种转场随机应用
- 🚫 **特效排除管理** - 可排除不喜欢的特效，避免重复选择
- 📝 **SRT字幕支持** - 自动解析SRT文件，支持时间格式纠错
- 🎵 **双音频轨道** - 解说音频100%，背景音频10%，独立控制
- 📦 **批量生成功能** - 一键生成多个混剪视频
- ⚙️ **完整配置管理** - 所有参数可自定义调整

## 🚀 快速开始

### 一键启动（推荐）

```bash
python interactive_automix.py
```

### 功能菜单

启动后会看到交互式菜单：

```
🎬 剪映自动混剪工具
1. 🎬 自动混剪
2. 📊 查看配置  
3. ⚙️ 修改配置
4. 🛡️ Pexels防审核设置
5. 🚫 特效/滤镜排除管理
6. 📦 批量生成
7. ❌ 退出
```

## 📁 素材库结构

工具会自动扫描素材库，推荐的目录结构：

```
素材库/
├── A83/                    # 产品型号文件夹
│   ├── 场景1/              # 场景子文件夹
│   │   ├── video1.mp4      # 视频文件
│   │   ├── video2.mp4
│   │   └── subtitle.srt    # 字幕文件（可选）
│   ├── 场景2/
│   │   ├── video3.mp4
│   │   └── narration.mp3   # 解说音频（可选）
│   └── 背景音乐.mp3        # 背景音频（可选）
├── B95/                    # 其他产品型号
└── 音效/                  # 环境音效库
    ├── 环境音1.mp3
    └── 环境音2.mp3
```

## 🎯 主要功能详解

### 🎬 自动混剪

- **智能素材选择**：从每个场景文件夹选择视频，确保内容多样性
- **时长控制**：生成30-40秒标准短视频，去掉前3秒无效内容
- **画面优化**：110%缩放，随机亮度/对比度调整
- **音频处理**：视频静音，解说100%音量，背景10%音量

### 🛡️ 防审核系统

- **Pexels覆盖层**：自动下载风景视频作为5%不透明度覆盖层
- **数字指纹改变**：有效改变视频数字指纹，防止平台识别
- **智能时长匹配**：自动调整覆盖层时长以匹配目标视频
- **备用机制**：网络失败时使用本地备用视频

### 🎨 特效系统

- **随机特效**：从912种视频特效中智能选择
- **随机滤镜**：从468种滤镜中选择，强度50-80%随机
- **随机转场**：从362种转场效果中选择
- **排除管理**：可排除不喜欢的效果，避免重复

### 📝 字幕处理

- **SRT格式支持**：自动解析SRT字幕文件
- **时间格式纠错**：修复常见的时间格式错误
- **多语言支持**：支持中文、英文、泰文等多种语言
- **样式设置**：白色字体，底部居中显示

## ⚙️ 配置说明

### 基础配置

```ini
[JianYingDraft.automix]
# 素材库路径
material_path=F:\Windows_data\Videos\B日期分类\素材
# 草稿输出路径
draft_output_path=C:\Users\用户名\AppData\Local\JianyingPro\User Data\Projects\com.lveditor.draft
# 视频时长范围（微秒）
video_duration_min=30000000  # 30秒
video_duration_max=40000000  # 40秒
```

### 防审核配置

```ini
# Pexels API密钥
pexels_api_key=your_api_key_here
# 覆盖层不透明度（5%推荐）
pexels_overlay_opacity=0.05
# 是否启用防审核覆盖层
enable_pexels_overlay=true
```

## 📦 批量生成

支持一键生成多个混剪视频：

1. 选择菜单 `6. 📦 批量生成`
2. 输入生成数量（默认5个）
3. 系统自动生成多个不同的混剪版本
4. 每个版本使用不同的素材组合和特效

## 🔧 高级功能

### 特效排除管理

- **查看已排除**：显示当前排除的特效列表
- **添加排除**：从可用特效中选择要排除的
- **移除排除**：恢复之前排除的特效
- **批量操作**：支持批量添加/移除

### 配置管理

- **查看配置**：显示当前所有配置参数
- **修改配置**：交互式修改各项参数
- **实时生效**：配置修改后立即生效
- **配置验证**：自动验证配置的有效性

## 🛠️ 技术架构

### 核心模块

- **StandardAutoMix**：标准化自动混剪核心引擎
- **PexelsManager**：Pexels API集成和防审核管理
- **EffectExclusionManager**：特效排除管理系统
- **ConfigManager**：配置管理系统
- **MetadataManager**：元数据管理（特效、滤镜、转场）

### 依赖库

- **pyJianYingDraft**：剪映草稿文件操作库
- **requests**：HTTP请求处理
- **configparser**：配置文件解析
- **pathlib**：路径操作
- **json**：JSON数据处理

## 📋 系统要求

- **Python 3.8+**
- **Windows 10/11**（剪映支持）
- **剪映专业版**已安装
- **网络连接**（Pexels功能需要）

## 🔍 常见问题

### Q: 生成的草稿在剪映中打不开？
A: 检查草稿输出路径是否正确，确保剪映已正确安装。

### Q: 防审核覆盖层不显示？
A: 检查Pexels API密钥是否有效，网络连接是否正常。

### Q: 特效/滤镜没有应用？
A: 检查是否在排除列表中，或者概率设置是否过低。

### Q: 字幕显示异常？
A: 检查SRT文件格式是否正确，时间戳是否有效。

## 📄 许可证

本项目基于原始项目进行重大改进和扩展，采用开源许可证。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📞 支持

如果遇到问题或需要帮助，请：
1. 查看本README文档
2. 检查配置文件设置
3. 查看生成的日志文件
4. 提交Issue描述问题

---

**🎉 享受智能视频混剪的乐趣吧！**
